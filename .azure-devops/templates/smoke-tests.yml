parameters:
- name: pythonVersion
  type: string
  default: '3.8.x'
- name: architecture
  type: string
  default: 'x64'
- name: azureCLIVersion
  type: string
  default: released
  values:
  - min
  - released
  - msi

steps:
  - template: setup-dev-test-env.yml
    parameters:
      architecture: ${{ parameters.architecture }}
      pythonVersion: ${{ parameters.pythonVersion }}
      azureCLIVersion: ${{ parameters.azureCLIVersion }}
    
  - task: PowerShell@2
    displayName: 'Run smoke test commands'
    inputs:
      targetType: 'inline'
      script: 'azext_iot\smoke_tests\commands_test.ps1'
      workingDirectory: '$(System.ArtifactsDirectory)/extension'